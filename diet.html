<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="bmi.css" />
    <script src="bmi.js" defer></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="nav-logo">
      <div class="hamburger" onclick="toggleMenu()">â˜°</div>
      <div class="nav-logo-text" id="pagetitle">BMI Calculator</div>
    </div>
    <div class="layout-container">
      <nav id="navLinks">
        <div class="nav-links">
          <a href="index.html">Calculator</a>
          <a href="about.html">About</a>
          <a href="diet.html">Diet Plan</a>
          <a href="contact.html">Contact</a>
        </div>
      </nav>
      <section>
        <div class="main-section">
          <div class="main-heading">
            What are we having <strong>today ?</strong>
          </div>
          <div class="filters">
            <label for="healthFilter">Filter by health:</label>
            <select id="healthFilter">
              <option value="all">All</option>
              <option value="vegan">Vegan</option>
              <option value="vegetarian">Vegetarian</option>
              <option value="paleo">Paleo</option>
              <option value="dairy-free">Dairy Free</option>
              <option value="gluten-free">Gluten Free</option>
              <option value="low-sugar">Low Sugar</option>
              <option value="egg-free">Egg Free</option>
              <option value="peanut-free">Peanut Free</option>
              <option value="tree-nut-free">Tree Nut Free</option>
              <option value="soy-free">Soy Free</option>
              <option value="fish-free">Fish Free</option>
              <option value="shellfish-free">Shellfish Free</option>
            </select>
          </div>

          <div id="dietcontainer" class="dietcontainer"></div>

          <!-- <script>   
document.addEventListener("DOMContentLoaded", () => {
  const Mealplan = JSON.parse(sessionStorage.getItem("Mealplan"));
  if (!Mealplan || !Mealplan.week) {
    document.getElementById("dietcontainer").innerHTML = `No meal plan found. Calculate BMI First <a href="index.html">Calculate!</a>`
    return;
  }

  const baseUrl = "https://spoonacular.com/recipeImages/";
  const container = document.getElementById("dietcontainer");

  container.innerHTML = ""; // clear container

  Object.keys(Mealplan.week).forEach(day => {
    const dayData = Mealplan.week[day];
    const meals = dayData.meals;
    const nutrients = dayData.nutrients;

    // Day heading
    // const dayHeading = document.createElement("h2");
    // dayHeading.textContent = day.charAt(0).toUpperCase() + day.slice(1);
    // container.appendChild(dayHeading);

    meals.forEach(meal => {
      // Outer card
      const mealCard = document.createElement("div");
      mealCard.classList.add("mealcontainer");

      // Inner container
      const inner = document.createElement("div");
      inner.classList.add("mealcontainer-inner");

      // Front (image)
      const front = document.createElement("div");
      front.classList.add("mealcontainer-front");
      front.innerHTML = `<img src="${baseUrl}${meal.image}" alt="${meal.title}">`;

      // Back (details)
      const back = document.createElement("div");
      back.classList.add("mealcontainer-back");

      // Per-meal nutrients
      const mealCount = meals.length;
      const calories = (nutrients.calories / mealCount).toFixed(0);
      const protein = (nutrients.protein / mealCount).toFixed(1);
      const fat = (nutrients.fat / mealCount).toFixed(1);
      const carbs = (nutrients.carbohydrates / mealCount).toFixed(1);

      back.innerHTML = `
        <h3>${meal.title}</h3>
        <div class="nutrition-info">
          <p><strong>Servings:</strong> ${meal.servings || 'N/A'}</p>
          <p><strong>Calories:</strong> ${calories} kcal</p>
          <p><strong>Protein:</strong> ${protein} g</p>
          <p><strong>Fat:</strong> ${fat} g</p>
          <p><strong>Carbohydrates:</strong> ${carbs} g</p>
        </div>
        <a href="${meal.sourceUrl}" target="_blank" class="review-button">View Recipe</a>
      `;

      // Assemble card
      inner.appendChild(front);
      inner.appendChild(back);
      mealCard.appendChild(inner);
      container.appendChild(mealCard);
    });
  });
});
</script> -->

          <script>
            document.addEventListener("DOMContentLoaded", () => {
              const Mealplan = JSON.parse(sessionStorage.getItem("Mealplan"));
              console.log(Mealplan);

              const container = document.getElementById("dietcontainer");
              const healthFilter = document.getElementById("healthFilter");

              if (!Mealplan || !Mealplan.hits) {
                container.innerHTML = `
                  No meal data found. Calculate BMI first! <a href="index.html">Calculate!</a>
                `;
                return;
                }

              // Function to render recipes
              function renderRecipes(recipes) {
                container.innerHTML = ""; // clear container
                recipes.forEach((item) => {
                  const card = document.createElement("div");
                  card.classList.add("mealcard");
                  card.innerHTML = `
                  <h3>${item.recipe.label}</h3>
                  <img src="${item.recipe.image}" alt="${item.recipe.label}" />
                  <p>Calories: ${Math.round(item.recipe.calories)}</p>
                  <a href="${item.recipe.url}" target="_blank">View Recipe</a> `;
                  container.appendChild(card);
                });
              }

              // Initial render
              renderRecipes(Mealplan.hits);

              // Filter change event
              healthFilter.addEventListener("change", () => {
                const selected = healthFilter.value;

                if (selected === "all") {
                  renderRecipes(Mealplan.hits);
                } else {
                  // Filter recipes by health label
                  const filtered = Mealplan.hits.filter((item) =>
                    item.recipe.healthLabels
                      .map((label) => label.toLowerCase())
                      .includes(selected)
                  );
                  renderRecipes(filtered);
                }
              });
            });
          </script>
        </div>
      </section>
    </div>
  </body>
</html>
